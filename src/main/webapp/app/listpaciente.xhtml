<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:pm="http://primefaces.org/mobile"
	xmlns:p="http://primefaces.org/ui">

<p:dataGrid value="#{cuideBemMB.pacientes}" var="pacienteView" rows="5" widgetVar="datapaciente" emptyMessage="Nenhum paciente cadastrado" columns="1">

  <p:panel toggleable="true" header="#{pacienteView.paciente.nome}" collapsed="true">  
 <pm:field>
 <p:outputLabel value="Foto:" for="pacfoto"></p:outputLabel>
 <p:graphicImage id="pacfoto" value="#{pacienteView.photoPaciente}" stream="false" alt="Foto nÃ£o cadastrada"/>
 </pm:field>
 
 <pm:field>
 <p:outputLabel value="Cuidadores:" for="paccuidador"></p:outputLabel>
 <p:dataTable emptyMessage="Nenhum Cuidador cadastrado" id="paccuidador" value="#{pacienteView.cuidadores}" var="cuidador" styleClass="ui-bar-f">
 <p:column headerText="Nome">
 <h:outputText value="#{cuidador.nome}" />
 </p:column>
 <p:column headerText="Email">
 <h:outputText value="#{cuidador.email}" />
 </p:column>
  <p:column>
   <h:form>
<p:commandButton  icon="ui-icon-delete" value="Excluir" 
		iconPos="right"></p:commandButton>
 </h:form>
 </p:column>
 
 </p:dataTable>
</pm:field>
<pm:field>
<h:form>
	<p:commandButton icon="ui-icon-plus" value="Convidar Cuidador" iconPos="right" actionListener="#{cuideBemMB.editPacienteView(pacienteView)}" oncomplete="PF('dlgCuidador').show();">
	</p:commandButton>
	</h:form>
</pm:field>	
<pm:field>
	<p:outputLabel value="Principal:" for="pacprincipal"></p:outputLabel>
	<p:inputSwitch  id="pacprincipal" 
		value="#{pacienteView.principal}"></p:inputSwitch>
</pm:field>

<pm:field>
  <h:form>
	<p:commandButton icon="ui-icon-grid" value="Agenda" actionListener="#{cuideBemMB.editPacienteView(pacienteView)}"
		action="pm:rotinas2" iconPos="right" update="@(#rotinas2)">
		</p:commandButton>
<p:commandButton  icon="ui-icon-delete" value="Excluir" update="@widgetVar(datapaciente)"
		actionListener="#{cuideBemMB.excluirPaciente(pacienteView)}" iconPos="right"></p:commandButton>
			<p:commandButton icon="ui-icon-edit" value="Editar" actionListener="#{cuideBemMB.editPaciente(pacienteView)}"
		action="pm:cadpaciente" iconPos="right" update="@(#cadpaciente)">
		
		</p:commandButton>
		
	  </h:form>	
</pm:field>
 
   </p:panel>
</p:dataGrid>

<p:dialog header="Convidar Cuidador" widgetVar="dlgCuidador" showEffect="pop">

<h:form >
<pm:field id="convitecuid">
<p:messages showDetail="true"></p:messages>
    <p:outputLabel value="Email:" for="emailCuid"></p:outputLabel>
    <p:inputText type="email" value="#{cuideBemMB.emailCuidador}" required="true" id="emailCuid">
  <p:keyFilter mask="email"></p:keyFilter>
    </p:inputText>
</pm:field>
 <p:commandButton value="Convidar"  actionListener="#{cuideBemMB.convidarCuidador}" update="convitecuid">
 <f:ajax onevent="PF('dlgCuidador').hide();" ></f:ajax>
 </p:commandButton>
 </h:form>   
</p:dialog>        
</html>
